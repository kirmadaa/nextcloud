/*! For license information please see mail.535.7037611a355a1d8f232e.js.LICENSE.txt */
(self.webpackChunknextcloud_mail=self.webpackChunknextcloud_mail||[]).push([[535],{57092:(t,e,n)=>{var o={"./af":18474,"./af.js":18474,"./ar":14630,"./ar.js":14630,"./ast":34117,"./ast.js":34117,"./az":17614,"./az.js":17614,"./bg":33442,"./bg.js":33442,"./bn":94217,"./bn.js":94217,"./bs":87710,"./bs.js":87710,"./ca":76477,"./ca.js":76477,"./cs":30315,"./cs.js":30315,"./da":21630,"./da.js":21630,"./de":13842,"./de-ch":32172,"./de-ch.js":32172,"./de.js":13842,"./el":90908,"./el.js":90908,"./en-au":4661,"./en-au.js":4661,"./en-gb":8966,"./en-gb.js":8966,"./eo":20645,"./eo.js":20645,"./es":58017,"./es-co":37096,"./es-co.js":37096,"./es.js":58017,"./et":46772,"./et.js":46772,"./eu":94715,"./eu.js":94715,"./fa":37232,"./fa.js":37232,"./fi":56536,"./fi.js":56536,"./fr":84505,"./fr.js":84505,"./gl":2878,"./gl.js":2878,"./gu":91173,"./gu.js":91173,"./he":32214,"./he.js":32214,"./hi":89810,"./hi.js":89810,"./hr":78951,"./hr.js":78951,"./hu":1798,"./hu.js":1798,"./id":15976,"./id.js":15976,"./it":27032,"./it.js":27032,"./ja":22668,"./ja.js":22668,"./jv":43881,"./jv.js":43881,"./kk":87083,"./kk.js":87083,"./km":45713,"./km.js":45713,"./kn":54680,"./kn.js":54680,"./ko":17839,"./ko.js":17839,"./ku":76761,"./ku.js":76761,"./lt":82873,"./lt.js":82873,"./lv":52311,"./lv.js":52311,"./ms":31049,"./ms.js":31049,"./nb":94609,"./nb.js":94609,"./ne":64484,"./ne.js":64484,"./nl":53027,"./nl.js":53027,"./no":47622,"./no.js":47622,"./oc":7807,"./oc.js":7807,"./pl":56949,"./pl.js":56949,"./pt":4557,"./pt-br":77494,"./pt-br.js":77494,"./pt.js":4557,"./ro":80554,"./ro.js":80554,"./ru":31608,"./ru.js":31608,"./si":82917,"./si.js":82917,"./sk":73955,"./sk.js":73955,"./sl":96442,"./sl.js":96442,"./sq":20893,"./sq.js":20893,"./sr":22772,"./sr-latn":76220,"./sr-latn.js":76220,"./sr.js":22772,"./sv":90152,"./sv.js":90152,"./th":11813,"./th.js":11813,"./tk":82076,"./tk.js":82076,"./tr":28411,"./tr.js":28411,"./tt":49185,"./tt.js":49185,"./ug":54813,"./ug.js":54813,"./uk":37977,"./uk.js":37977,"./ur":65218,"./ur.js":65218,"./uz":14010,"./uz.js":14010,"./vi":36443,"./vi.js":36443,"./zh":78251,"./zh-cn":91773,"./zh-cn.js":91773,"./zh.js":78251};function i(t){return r(t).then((t=>n.t(t,23)))}function r(t){return n.e(548).then((()=>{if(!n.o(o,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return o[t]}))}i.keys=()=>Object.keys(o),i.resolve=r,i.id=57092,t.exports=i},4728:(t,e,n)=>{"use strict";n.d(e,{Ay:()=>s,TB:()=>r,Xu:()=>i});var o=n(20738);const i="change_alias",r="editor_ready";class s extends o.A{removeSignatureElement(t,e){const n=t.model.createRangeIn(t.model.document.getRoot());for(const t of n.getWalker({shallow:!0}))t.item.is("element")&&"signature"===t.item.name&&e.remove(t.item)}insertSignatureElement(t,e,n,o){if(0===n.length)return;const i=t.data.processor.toView(n),r=t.data.toModel(i),s=e.createElement("signature");e.append(e.createText("-- "),s),e.append(e.createElement("paragraph"),s),e.append(r,s),o&&e.append(e.createElement("paragraph"),s);const a=this.findPosition(t,e,o);t.model.insertContent(s,a)}findPosition(t,e,n){if(n){const n=t.model.createRangeIn(t.model.document.getRoot());for(const t of n.getWalker({shallow:!0}))if(t.item.is("element")&&"quote"===t.item.name)return e.createPositionBefore(t.item)}return e.createPositionAt(t.model.document.getRoot(),"end")}hasSignatureElement(t){const e=t.model.createRangeIn(t.model.document.getRoot());for(const t of e.getWalker({shallow:!0}))if(t.item.is("element")){if("quote"===t.item.name)continue;if("signature"===t.item.name)return!0}return!1}execute(t,e,n){this.editor.model.change((o=>{t===i&&(this.removeSignatureElement(this.editor,o),this.insertSignatureElement(this.editor,o,e,n)),t!==r||this.hasSignatureElement(this.editor)||this.insertSignatureElement(this.editor,o,e,n)}))}refresh(){this.isEnabled=!0}}},8504:(t,e,n)=>{"use strict";n.d(e,{A:()=>a});var o=n(71354),i=n.n(o),r=n(76314),s=n.n(r)()(i());s.push([t.id,".editor[data-v-5f333c85]{width:100%;height:calc(100% - 75px);overflow:scroll;margin-bottom:10px}.editor.ck[data-v-5f333c85]{border:none !important;box-shadow:none !important;padding:0}[data-v-5f333c85] a{color:#07d}[data-v-5f333c85] p{cursor:text;margin:0 !important}","",{version:3,sources:["webpack://./src/components/TextEditor.vue"],names:[],mappings:"AACA,yBACC,UAAA,CACA,wBAAA,CACA,eAAA,CACA,kBAAA,CAEA,4BACC,sBAAA,CACA,0BAAA,CACA,SAAA,CAIF,oBACC,UAAA,CAED,oBACC,WAAA,CACA,mBAAA",sourcesContent:["\n.editor {\n\twidth: 100%;\n\theight: calc(100% - 75px);\n\toverflow: scroll;\n\tmargin-bottom: 10px;\n\n\t&.ck {\n\t\tborder: none !important;\n\t\tbox-shadow: none !important;\n\t\tpadding: 0;\n\t}\n}\n\n:deep(a) {\n\tcolor: #07d;\n}\n:deep(p) {\n\tcursor: text;\n\tmargin: 0 !important;\n}\n"],sourceRoot:""}]);const a=s},61333:(t,e,n)=>{"use strict";n.d(e,{A:()=>a});var o=n(71354),i=n.n(o),r=n(76314),s=n.n(r)()(i());s.push([t.id,"\n/*\nOverwrite the default z-index for CKEditor\nhttps://github.com/ckeditor/ckeditor5/issues/1142\n */\n.ck .ck-reset {\n\tbackground: var(--color-main-background) !important;\n}\n/* Default ckeditor value of padding-inline-start, to overwrite the global styling from server */\n.ck-content ul, .ck-content ol {\n\tpadding-inline-start: 40px;\n}\n.ck-list__item {\n.ck-off {\n\t\tbackground:var(--color-main-background) !important;\n}\n.ck-on {\n\t\tbackground:var(--color-primary-element-light) !important;\n}\n}\n.custom-item-username {\n\tcolor: var(--color-main-text) !important;\n}\n.link-title{\n\tcolor: var(--color-main-text) !important;\n\tmargin-left: var(--default-grid-baseline) !important;\n}\n.link-icon {\n\twidth: 16px !important;\n}\n.link-icon{\n\tfilter : var(--background-invert-if-dark);\n\twidth: 16px !important;\n\tmargin-right: 5px !important;\n}\n.custom-item {\n\twidth : 100% !important;\n\tborder-radius : 8px !important;\n\tpadding : 4px 8px !important;\n\tdisplay :block;\n\tbackground:var(--color-main-background)!important;\n}\n.custom-item:hover {\n\tbackground:var(--color-primary-element-light)!important;\n}\n.link-container{\n\tborder-radius :8px !important;\n\tpadding :4px 8px !important;\n\tdisplay : block;\n\twidth : 100% !important;\n\tbackground:var(--color-main-background)!important;\n}\n.link-container:hover {\n\tbackground:var(--color-primary-element-light)!important;\n}\n:root {\n\t--ck-z-default: 10000;\n\t--ck-balloon-border-width:  0;\n}\n","",{version:3,sources:["webpack://./src/components/TextEditor.vue"],names:[],mappings:";AAwYA;;;EAGA;AACA;CACA,mDAAA;AACA;AACA,gGAAA;AACA;CACA,0BAAA;AACA;AACA;AACA;EACA,kDAAA;AACA;AACA;EACA,wDAAA;AACA;AACA;AACA;CACA,wCAAA;AACA;AACA;CACA,wCAAA;CACA,oDAAA;AACA;AACA;CACA,sBAAA;AACA;AACA;CACA,yCAAA;CACA,sBAAA;CACA,4BAAA;AACA;AACA;CACA,uBAAA;CACA,8BAAA;CACA,4BAAA;CACA,cAAA;CACA,iDAAA;AACA;AACA;CACA,uDAAA;AACA;AACA;CACA,6BAAA;CACA,2BAAA;CACA,eAAA;CACA,uBAAA;CACA,iDAAA;AACA;AACA;CACA,uDAAA;AACA;AACA;CACA,qBAAA;CACA,6BAAA;AACA",sourcesContent:["\x3c!--\n  - @copyright 2019 Christoph Wurst <christoph@winzerhof-wurst.at>\n  -\n  - @author 2019 Christoph Wurst <christoph@winzerhof-wurst.at>\n  - @author 2022 Richard Steinmetz <richard@steinmetz.cloud>\n  -\n  - @license AGPL-3.0-or-later\n  -\n  - This program is free software: you can redistribute it and/or modify\n  - it under the terms of the GNU Affero General Public License as\n  - published by the Free Software Foundation, either version 3 of the\n  - License, or (at your option) any later version.\n  -\n  - This program is distributed in the hope that it will be useful,\n  - but WITHOUT ANY WARRANTY; without even the implied warranty of\n  - MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n  - GNU Affero General Public License for more details.\n  -\n  - You should have received a copy of the GNU Affero General Public License\n  - along with this program.  If not, see <http://www.gnu.org/licenses/>.\n  --\x3e\n\n<template>\n\t<div>\n\t\t<ckeditor v-if=\"ready\"\n\t\t\t:value=\"value\"\n\t\t\t:config=\"config\"\n\t\t\t:editor=\"editor\"\n\t\t\t:disabled=\"disabled\"\n\t\t\tclass=\"editor\"\n\t\t\t@input=\"onEditorInput\"\n\t\t\t@ready=\"onEditorReady\" />\n\t\t<div ref=\"container\" class=\"toolbar\" />\n\t</div>\n</template>\n\n<script>\nimport CKEditor from '@ckeditor/ckeditor5-vue2'\nimport AlignmentPlugin from '@ckeditor/ckeditor5-alignment/src/alignment.js'\nimport { Mention } from '@ckeditor/ckeditor5-mention'\nimport Editor from '@ckeditor/ckeditor5-editor-decoupled/src/decouplededitor.js'\nimport EssentialsPlugin from '@ckeditor/ckeditor5-essentials/src/essentials.js'\nimport BlockQuotePlugin from '@ckeditor/ckeditor5-block-quote/src/blockquote.js'\nimport BoldPlugin from '@ckeditor/ckeditor5-basic-styles/src/bold.js'\nimport FontPlugin from '@ckeditor/ckeditor5-font/src/font.js'\nimport ParagraphPlugin from '@ckeditor/ckeditor5-paragraph/src/paragraph.js'\nimport HeadingPlugin from '@ckeditor/ckeditor5-heading/src/heading.js'\nimport ItalicPlugin from '@ckeditor/ckeditor5-basic-styles/src/italic.js'\nimport LinkPlugin from '@ckeditor/ckeditor5-link/src/link.js'\nimport ListStyle from '@ckeditor/ckeditor5-list/src/liststyle.js'\nimport RemoveFormat from '@ckeditor/ckeditor5-remove-format/src/removeformat.js'\nimport SignaturePlugin from '../ckeditor/signature/SignaturePlugin.js'\nimport StrikethroughPlugin from '@ckeditor/ckeditor5-basic-styles/src/strikethrough.js'\nimport QuotePlugin from '../ckeditor/quote/QuotePlugin.js'\nimport Base64UploadAdapter from '@ckeditor/ckeditor5-upload/src/adapters/base64uploadadapter.js'\nimport ImagePlugin from '@ckeditor/ckeditor5-image/src/image.js'\nimport ImageResizePlugin from '@ckeditor/ckeditor5-image/src/imageresize.js'\nimport ImageUploadPlugin from '@ckeditor/ckeditor5-image/src/imageupload.js'\nimport { DropdownView } from '@ckeditor/ckeditor5-ui'\nimport MailPlugin from '../ckeditor/mail/MailPlugin.js'\nimport { searchProvider, getLinkWithPicker } from '@nextcloud/vue/dist/Components/NcRichText.js'\nimport { getLanguage } from '@nextcloud/l10n'\nimport logger from '../logger.js'\nimport PickerPlugin from '../ckeditor/smartpicker/PickerPlugin.js'\nimport { emojiSearch, emojiAddRecent } from '@nextcloud/vue'\n\nexport default {\n\tname: 'TextEditor',\n\tcomponents: {\n\t\tckeditor: CKEditor.component,\n\t},\n\tprops: {\n\t\tvalue: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\thtml: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t\tplaceholder: {\n\t\t\ttype: String,\n\t\t\tdefault: '',\n\t\t},\n\t\tfocus: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t\tbus: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tdisabled: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\tdata() {\n\t\tconst plugins = [\n\t\t\tEssentialsPlugin,\n\t\t\tParagraphPlugin,\n\t\t\tSignaturePlugin,\n\t\t\tQuotePlugin,\n\t\t\tPickerPlugin,\n\t\t\tMention,\n\t\t]\n\t\tconst toolbar = ['undo', 'redo']\n\n\t\tif (this.html) {\n\t\t\tplugins.push(...[\n\t\t\t\tHeadingPlugin,\n\t\t\t\tAlignmentPlugin,\n\t\t\t\tBoldPlugin,\n\t\t\t\tItalicPlugin,\n\t\t\t\tBlockQuotePlugin,\n\t\t\t\tLinkPlugin,\n\t\t\t\tListStyle,\n\t\t\t\tFontPlugin,\n\t\t\t\tRemoveFormat,\n\t\t\t\tStrikethroughPlugin,\n\t\t\t\tImagePlugin,\n\t\t\t\tImageUploadPlugin,\n\t\t\t\tBase64UploadAdapter,\n\t\t\t\tImageResizePlugin,\n\t\t\t\tMailPlugin,\n\t\t\t])\n\t\t\ttoolbar.unshift(...[\n\t\t\t\t'heading',\n\t\t\t\t'fontFamily',\n\t\t\t\t'fontSize',\n\t\t\t\t'bold',\n\t\t\t\t'italic',\n\t\t\t\t'fontColor',\n\t\t\t\t'imageUpload',\n\t\t\t\t'alignment',\n\t\t\t\t'bulletedList',\n\t\t\t\t'numberedList',\n\t\t\t\t'blockquote',\n\t\t\t\t'fontBackgroundColor',\n\t\t\t\t'strikethrough',\n\t\t\t\t'link',\n\t\t\t\t'removeFormat',\n\t\t\t])\n\t\t}\n\n\t\treturn {\n\t\t\tlinkTribute: null,\n\t\t\temojiTribute: null,\n\t\t\ttextSmiles: [],\n\t\t\tready: false,\n\t\t\teditor: Editor,\n\t\t\tconfig: {\n\t\t\t\tplaceholder: this.placeholder,\n\t\t\t\tplugins,\n\t\t\t\ttoolbar: {\n\t\t\t\t\titems: toolbar,\n\t\t\t\t},\n\t\t\t\tlanguage: 'en',\n\t\t\t\tmention: {\n\t\t\t\t\tfeeds: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tmarker: ':',\n\t\t\t\t\t\t\tfeed: this.getEmoji,\n\t\t\t\t\t\t\titemRenderer: this.customEmojiRenderer,\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tmarker: '/',\n\t\t\t\t\t\t\tfeed: this.getLink,\n\t\t\t\t\t\t\titemRenderer: this.customLinkRenderer,\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t},\n\t\t\t},\n\t\t}\n\t},\n\tbeforeMount() {\n\t\tthis.loadEditorTranslations(getLanguage())\n\t},\n\tmethods: {\n\t\tgetLink(text) {\n\t\t\tconst results = searchProvider(text)\n\t\t\tif (results.length === 1 && !results[0].title.toLowerCase().includes(text.toLowerCase())) {\n\t\t\t\treturn []\n\t\t\t}\n\t\t\treturn results\n\t\t},\n\t\tgetEmoji(text) {\n\t\t\tconst emojiResults = emojiSearch(text)\n\t\t\tif (this.textSmiles.includes(':' + text)) {\n\n\t\t\t\temojiResults.unshift(':' + text)\n\t\t\t}\n\t\t\treturn emojiResults\n\t\t},\n\t\t customEmojiRenderer(item) {\n\t\t\tconst itemElement = document.createElement('span')\n\n\t\t\titemElement.classList.add('custom-item')\n\t\t\titemElement.id = `mention-list-item-id-${item.colons}`\n\t\t\titemElement.textContent = `${item.native} `\n\t\t\tconst usernameElement = document.createElement('span')\n\n\t\t\tusernameElement.classList.add('custom-item-username')\n\t\t\tusernameElement.textContent = item.colons\n\n\t\t\titemElement.appendChild(usernameElement)\n\n\t\t\treturn itemElement\n\t\t},\n\t\tcustomLinkRenderer(item) {\n\t\t\tconst itemElement = document.createElement('span')\n\t\t\titemElement.classList.add('link-container')\n\n\t\t\tconst icon = document.createElement('img')\n\t\t\ticon.classList.add('link-icon')\n\t\t\ticon.src = `${item.icon_url} `\n\n\t\t\tconst usernameElement = document.createElement('span')\n\n\t\t\tusernameElement.classList.add('link-title')\n\t\t\tusernameElement.textContent = `${item.title} `\n\t\t\titemElement.appendChild(icon)\n\t\t\titemElement.appendChild(usernameElement)\n\n\t\t\treturn itemElement\n\t\t},\n\t\toverrideDropdownPositionsToNorth(editor, toolbarView) {\n\t\t\tconst {\n\t\t\t\tsouth, north, southEast, southWest, northEast, northWest,\n\t\t\t\tsouthMiddleEast, southMiddleWest, northMiddleEast, northMiddleWest,\n\t\t\t} = DropdownView.defaultPanelPositions\n\n\t\t\tlet panelPositions\n\n\t\t\tif (editor.locale.uiLanguageDirection !== 'rtl') {\n\t\t\t\tpanelPositions = [\n\t\t\t\t\tnorthEast, northWest, northMiddleEast, northMiddleWest, north,\n\t\t\t\t\tsouthEast, southWest, southMiddleEast, southMiddleWest, south,\n\t\t\t\t]\n\t\t\t} else {\n\t\t\t\tpanelPositions = [\n\t\t\t\t\tnorthWest, northEast, northMiddleWest, northMiddleEast, north,\n\t\t\t\t\tsouthWest, southEast, southMiddleWest, southMiddleEast, south,\n\t\t\t\t]\n\t\t\t}\n\n\t\t\tfor (const item of toolbarView.items) {\n\t\t\t\tif (!(item instanceof DropdownView)) {\n\t\t\t\t\tcontinue\n\t\t\t\t}\n\n\t\t\t\titem.on('change:isOpen', () => {\n\t\t\t\t\tif (!item.isOpen) {\n\t\t\t\t\t\treturn\n\t\t\t\t\t}\n\n\t\t\t\t\titem.panelView.position = DropdownView._getOptimalPosition({\n\t\t\t\t\t\telement: item.panelView.element,\n\t\t\t\t\t\ttarget: item.buttonView.element,\n\t\t\t\t\t\tfitInViewport: true,\n\t\t\t\t\t\tpositions: panelPositions,\n\t\t\t\t\t}).name\n\t\t\t\t})\n\t\t\t}\n\t\t},\n\t\toverrideTooltipPositions(toolbarView) {\n\t\t\tfor (const item of toolbarView.items) {\n\t\t\t\tif (item.buttonView) {\n\t\t\t\t\titem.buttonView.tooltipPosition = 'n'\n\t\t\t\t} else if (item.tooltipPosition) {\n\t\t\t\t\titem.tooltipPosition = 'n'\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tasync loadEditorTranslations(language) {\n\t\t\tif (language === 'en') {\n\t\t\t\t// The default, nothing to fetch\n\t\t\t\treturn this.showEditor('en')\n\t\t\t}\n\n\t\t\ttry {\n\t\t\t\tlogger.debug(`loading ${language} translations for CKEditor`)\n\t\t\t\tawait import(\n\t\t\t\t\t/* webpackMode: \"lazy-once\" */\n\t\t\t\t\t/* webpackPrefetch: true */\n\t\t\t\t\t/* webpackPreload: true */\n\t\t\t\t\t`@ckeditor/ckeditor5-build-decoupled-document/build/translations/${language}`\n\t\t\t\t)\n\t\t\t\tthis.showEditor(language)\n\t\t\t} catch (error) {\n\t\t\t\tlogger.error(`could not find CKEditor translations for \"${language}\"`, { error })\n\t\t\t\tthis.showEditor('en')\n\t\t\t}\n\t\t},\n\t\tshowEditor(language) {\n\t\t\tlogger.debug(`using \"${language}\" as CKEditor language`)\n\t\t\tthis.config.language = language\n\n\t\t\tthis.ready = true\n\t\t},\n\t\t/**\n\t\t * @param {module:core/editor/editor~Editor} editor editor the editor instance\n\t\t */\n\t\tonEditorReady(editor) {\n\t\t\tlogger.debug('TextEditor is ready', { editor })\n\n\t\t\t// https://ckeditor.com/docs/ckeditor5/latest/examples/builds-custom/bottom-toolbar-editor.html\n\t\t\tif (editor.ui) {\n\t\t\t\tthis.$refs.container.appendChild(editor.ui.view.toolbar.element)\n\t\t\t\tthis.overrideDropdownPositionsToNorth(editor, editor.ui.view.toolbar)\n\t\t\t\tthis.overrideTooltipPositions(editor.ui.view.toolbar)\n\t\t\t}\n\n\t\t\teditor.commands.get('mention')?.on('execute', (event, data) => {\n\t\t\t\tevent.stop()\n\t\t\t\tconst eventData = data[0]\n\t\t\t\tconst item = eventData.mention\n\t\t\t\tif (eventData.marker === ':') {\n\t\t\t\t\temojiAddRecent(item)\n\t\t\t\t\tthis.editorInstance.execute('insertItem', item.native, ':')\n\t\t\t\t}\n\t\t\t\tif (eventData.marker === '/') {\n\t\t\t\t\tgetLinkWithPicker(item.id)\n\t\t\t\t\t\t.then((link) => {\n\t\t\t\t\t\t\tthis.editorInstance.execute('insertItem', link, '/')\n\t\t\t\t\t\t\tthis.editorInstance.editing.view.focus()\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.catch((error) => {\n\t\t\t\t\t\t\tconsole.debug('Smart picker promise rejected:', error)\n\t\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t}, { priority: 'high' })\n\t\t\tthis.editorInstance = editor\n\n\t\t\tif (this.focus) {\n\t\t\t\tlogger.debug('focusing TextEditor')\n\t\t\t\teditor.editing.view.focus()\n\t\t\t}\n\n\t\t\tif (this.html) {\n\t\t\t\tthis.$emit('show-toolbar', editor.ui._focusableToolbarDefinitions[0].toolbarView.element)\n\t\t\t}\n\t\t\tthis.bus.on('append-to-body-at-cursor', this.appendToBodyAtCursor)\n\t\t\tthis.$emit('ready', editor)\n\t\t},\n\t\tonEditorInput(text) {\n\t\t\tif (text !== this.value) {\n\t\t\t\tlogger.debug(`TextEditor input changed to <${text}>`)\n\t\t\t\tthis.$emit('input', text)\n\t\t\t}\n\t\t},\n\t\tappendToBodyAtCursor(toAppend) {\n\t\t\t// https://ckeditor.com/docs/ckeditor5/latest/builds/guides/faq.html#where-are-the-editorinserthtml-and-editorinserttext-methods-how-to-insert-some-content\n\t\t\tconst viewFragment = this.editorInstance.data.processor.toView(toAppend)\n\t\t\tconst modelFragment = this.editorInstance.data.toModel(viewFragment)\n\t\t\tthis.editorInstance.model.insertContent(modelFragment)\n\t\t},\n\t\teditorExecute(commandName, ...args) {\n\t\t\tif (this.editorInstance) {\n\t\t\t\tthis.editorInstance.execute(commandName, ...args)\n\t\t\t} else {\n\t\t\t\tthrow new Error('Impossible to execute a command before editor is ready.')\n\t\t\t}\n\t\t},\n\t},\n}\n<\/script>\n\n<style lang=\"scss\" scoped>\n.editor {\n\twidth: 100%;\n\theight: calc(100% - 75px);\n\toverflow: scroll;\n\tmargin-bottom: 10px;\n\n\t&.ck {\n\t\tborder: none !important;\n\t\tbox-shadow: none !important;\n\t\tpadding: 0;\n\t}\n}\n\n:deep(a) {\n\tcolor: #07d;\n}\n:deep(p) {\n\tcursor: text;\n\tmargin: 0 !important;\n}\n</style>\n\n<style>\n/*\nOverwrite the default z-index for CKEditor\nhttps://github.com/ckeditor/ckeditor5/issues/1142\n */\n .ck .ck-reset {\n\tbackground: var(--color-main-background) !important;\n }\n/* Default ckeditor value of padding-inline-start, to overwrite the global styling from server */\n.ck-content ul, .ck-content ol {\n\tpadding-inline-start: 40px;\n}\n.ck-list__item {\n\t.ck-off {\n\t\tbackground:var(--color-main-background) !important;\n\t}\n\t.ck-on {\n\t\tbackground:var(--color-primary-element-light) !important;\n\t}\n}\n.custom-item-username {\n\tcolor: var(--color-main-text) !important;\n }\n .link-title{\n\tcolor: var(--color-main-text) !important;\n\tmargin-left: var(--default-grid-baseline) !important;\n }\n .link-icon {\n\twidth: 16px !important;\n }\n .link-icon{\n\tfilter : var(--background-invert-if-dark);\n\twidth: 16px !important;\n\tmargin-right: 5px !important;\n }\n .custom-item {\n\twidth : 100% !important;\n\tborder-radius : 8px !important;\n\tpadding : 4px 8px !important;\n\tdisplay :block;\n\tbackground:var(--color-main-background)!important;\n }\n .custom-item:hover {\n\tbackground:var(--color-primary-element-light)!important;\n }\n .link-container{\n\tborder-radius :8px !important;\n\tpadding :4px 8px !important;\n\tdisplay : block;\n\twidth : 100% !important;\n\tbackground:var(--color-main-background)!important;\n }\n .link-container:hover {\n\tbackground:var(--color-primary-element-light)!important;\n }\n:root {\n\t--ck-z-default: 10000;\n\t--ck-balloon-border-width:  0;\n\t}\n</style>\n"],sourceRoot:""}]);const a=s},61535:(t,e,n)=>{"use strict";n.d(e,{A:()=>tt});var o=n(10349),i=n.n(o),r=n(77285),s=n(20655),a=n(68239),d=n(12381),l=n(98700),c=n(57712),m=n(13148),u=n(6137),h=n(10395),p=n(87237),A=n(61742),g=n(94969),f=n(46749),k=n(4888),b=n(4728);class C extends k.A{init(){this._defineSchema(),this._defineConverters(),this.editor.commands.add("insertSignature",new b.Ay(this.editor))}_defineSchema(){this.editor.model.schema.register("signature",{inheritAllFrom:"$container"})}_defineConverters(){this.editor.conversion.elementToElement({model:"signature",view:{name:"div",classes:"signature"}})}}var v=n(24186);class E extends k.A{init(){this._defineSchema(),this._defineConverters()}_defineSchema(){this.editor.model.schema.register("quote",{inheritAllFrom:"$container"})}_defineConverters(){this.editor.conversion.elementToElement({model:"quote",view:{name:"div",classes:"quote"}})}}var w=n(51687),j=n(58870),x=n(90585),y=n(29300),P=n(63663),T=n(72768);class I extends k.A{static get requires(){return[T.f]}init(){this._overwriteParagraphConversion()}_overwriteParagraphConversion(){this.editor.conversion.elementToElement({model:"paragraph",view:{name:"p",styles:{margin:0}},converterPriority:"high"})}}var B=n(64508),L=n(53334),R=n(85745),S=n(20738);class _ extends S.A{insertItem(t,e,n,o){const i=t.model.document.selection.getLastPosition();if(null===i)return;const r=t.model.createRange(i.getShiftedBy(-5),i).getWalker({shallow:!1,direction:"backward"});for(const i of r)if("text"===i.type&&i.item.data.includes(o)){e.remove(i.item);const r=i.item.data,s=r.lastIndexOf(o),a=e.createElement("paragraph");e.insertText(r.substring(0,s),a),t.model.insertContent(a);const d=e.createElement("paragraph");return e.insertText(n,d),void t.model.insertContent(d)}}execute(t,e){this.editor.model.change((n=>{this.insertItem(this.editor,n,t,e)}))}refresh(){this.isEnabled=!0}}class D extends k.A{init(){this.editor.commands.add("insertItem",new _(this.editor))}}var M=n(76904);const W={name:"TextEditor",components:{ckeditor:i().component},props:{value:{type:String,required:!0},html:{type:Boolean,default:!1},placeholder:{type:String,default:""},focus:{type:Boolean,default:!1},bus:{type:Object,required:!0},disabled:{type:Boolean,default:!1}},data(){const t=[d.A,u.A,C,E,D,s.PX],e=["undo","redo"];return this.html&&(t.push(h.A,r.A,c.A,p.A,l.A,A.A,g.A,m.A,f.A,v.A,j.A,y.A,w.A,x.A,I),e.unshift("heading","fontFamily","fontSize","bold","italic","fontColor","imageUpload","alignment","bulletedList","numberedList","blockquote","fontBackgroundColor","strikethrough","link","removeFormat")),{linkTribute:null,emojiTribute:null,textSmiles:[],ready:!1,editor:a.A,config:{placeholder:this.placeholder,plugins:t,toolbar:{items:e},language:"en",mention:{feeds:[{marker:":",feed:this.getEmoji,itemRenderer:this.customEmojiRenderer},{marker:"/",feed:this.getLink,itemRenderer:this.customLinkRenderer}]}}}},beforeMount(){this.loadEditorTranslations((0,L.Z0)())},methods:{getLink(t){const e=(0,B.kr)(t);return 1!==e.length||e[0].title.toLowerCase().includes(t.toLowerCase())?e:[]},getEmoji(t){const e=(0,M.Fo)(t);return this.textSmiles.includes(":"+t)&&e.unshift(":"+t),e},customEmojiRenderer(t){const e=document.createElement("span");e.classList.add("custom-item"),e.id="mention-list-item-id-".concat(t.colons),e.textContent="".concat(t.native," ");const n=document.createElement("span");return n.classList.add("custom-item-username"),n.textContent=t.colons,e.appendChild(n),e},customLinkRenderer(t){const e=document.createElement("span");e.classList.add("link-container");const n=document.createElement("img");n.classList.add("link-icon"),n.src="".concat(t.icon_url," ");const o=document.createElement("span");return o.classList.add("link-title"),o.textContent="".concat(t.title," "),e.appendChild(n),e.appendChild(o),e},overrideDropdownPositionsToNorth(t,e){const{south:n,north:o,southEast:i,southWest:r,northEast:s,northWest:a,southMiddleEast:d,southMiddleWest:l,northMiddleEast:c,northMiddleWest:m}=P.BO.defaultPanelPositions;let u;u="rtl"!==t.locale.uiLanguageDirection?[s,a,c,m,o,i,r,d,l,n]:[a,s,m,c,o,r,i,l,d,n];for(const t of e.items)t instanceof P.BO&&t.on("change:isOpen",(()=>{t.isOpen&&(t.panelView.position=P.BO._getOptimalPosition({element:t.panelView.element,target:t.buttonView.element,fitInViewport:!0,positions:u}).name)}))},overrideTooltipPositions(t){for(const e of t.items)e.buttonView?e.buttonView.tooltipPosition="n":e.tooltipPosition&&(e.tooltipPosition="n")},async loadEditorTranslations(t){if("en"===t)return this.showEditor("en");try{R.A.debug("loading ".concat(t," translations for CKEditor")),await n(57092)("./".concat(t)),this.showEditor(t)}catch(e){R.A.error('could not find CKEditor translations for "'.concat(t,'"'),{error:e}),this.showEditor("en")}},showEditor(t){R.A.debug('using "'.concat(t,'" as CKEditor language')),this.config.language=t,this.ready=!0},onEditorReady(t){var e;R.A.debug("TextEditor is ready",{editor:t}),t.ui&&(this.$refs.container.appendChild(t.ui.view.toolbar.element),this.overrideDropdownPositionsToNorth(t,t.ui.view.toolbar),this.overrideTooltipPositions(t.ui.view.toolbar)),null===(e=t.commands.get("mention"))||void 0===e||e.on("execute",((t,e)=>{t.stop();const n=e[0],o=n.mention;":"===n.marker&&((0,M.ZR)(o),this.editorInstance.execute("insertItem",o.native,":")),"/"===n.marker&&(0,B.J4)(o.id).then((t=>{this.editorInstance.execute("insertItem",t,"/"),this.editorInstance.editing.view.focus()})).catch((t=>{console.debug("Smart picker promise rejected:",t)}))}),{priority:"high"}),this.editorInstance=t,this.focus&&(R.A.debug("focusing TextEditor"),t.editing.view.focus()),this.html&&this.$emit("show-toolbar",t.ui._focusableToolbarDefinitions[0].toolbarView.element),this.bus.on("append-to-body-at-cursor",this.appendToBodyAtCursor),this.$emit("ready",t)},onEditorInput(t){t!==this.value&&(R.A.debug("TextEditor input changed to <".concat(t,">")),this.$emit("input",t))},appendToBodyAtCursor(t){const e=this.editorInstance.data.processor.toView(t),n=this.editorInstance.data.toModel(e);this.editorInstance.model.insertContent(n)},editorExecute(t){if(!this.editorInstance)throw new Error("Impossible to execute a command before editor is ready.");for(var e=arguments.length,n=new Array(e>1?e-1:0),o=1;o<e;o++)n[o-1]=arguments[o];this.editorInstance.execute(t,...n)}}};var V=n(85072),z=n.n(V),F=n(97825),O=n.n(F),q=n(77659),$=n.n(q),N=n(55056),U=n.n(N),K=n(10540),G=n.n(K),Q=n(41113),Y=n.n(Q),H=n(8504),X={};X.styleTagTransform=Y(),X.setAttributes=U(),X.insert=$().bind(null,"head"),X.domAPI=O(),X.insertStyleElement=G(),z()(H.A,X),H.A&&H.A.locals&&H.A.locals;var Z=n(61333),J={};J.styleTagTransform=Y(),J.setAttributes=U(),J.insert=$().bind(null,"head"),J.domAPI=O(),J.insertStyleElement=G(),z()(Z.A,J),Z.A&&Z.A.locals&&Z.A.locals;const tt=(0,n(14486).A)(W,(function(){var t=this,e=t._self._c;return e("div",[t.ready?e("ckeditor",{staticClass:"editor",attrs:{value:t.value,config:t.config,editor:t.editor,disabled:t.disabled},on:{input:t.onEditorInput,ready:t.onEditorReady}}):t._e(),t._v(" "),e("div",{ref:"container",staticClass:"toolbar"})],1)}),[],!1,null,"5f333c85",null).exports}}]);
//# sourceMappingURL=mail.535.7037611a355a1d8f232e.js.map